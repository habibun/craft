{% extends '::base.html.twig' %}

{% block body -%}
    <div class="row">
        <div class="col-md-6">
            <div>
                <a class="btn btn-sm btn-noty btn-warning" href="{{ path('purchase') }}">
                    <i class="fa fa-arrow-left"></i>
                </a>
                <a class="btn btn-sm btn-noty btn-success" href="{{ path('purchase_new') }}">
                    <i class="fa fa-plus"></i>
                </a>
                {% if purchase.status == statusSaved %}
                <a class="btn btn-sm btn-noty btn-primary" href="{{ path('purchase_edit', {'id' : purchase.id}) }}">
                    <i class="fa fa-pencil"></i>
                </a>
                <a class="btn btn-sm btn-noty btn-danger btn-delete" href="{{ path('purchase_delete', {'id' : purchase.id}) }}">
                    <i class="fa fa-trash-o"></i>
                </a>
                {% endif %}
            </div>
            <br />
        </div>
    </div>
    <div class="row">

        <div class="col-md-6">

            <div class="panel panel-archon">
                <div class="panel-heading">
                    <h3 class="panel-title">Purchase #{{ purchase.id }}
                        <span class="pull-right">
                            <a class="panel-minimize" href="#"><i class="fa fa-chevron-up"></i></a>
                        </span>
                    </h3>
                </div>
                <div class="panel-body">
                    <table class="table table-striped">
                        <tbody>
                        <tr>
                            <th>Id</th>
                            <td>{{ purchase.id }}</td>
                        </tr>
                        <tr>
                            <th>Company</th>
                            <td><a href="{{ path('company_show', {'id' : purchase.company.id}) }}">{{ purchase.company }}</a></td>
                        </tr>
                        <tr>
                            <th>Location</th>
                            <td>{{ purchase.getLocation().getLocationName() }}</td>
                        </tr>
                        <tr>
                            <th>Date</th>
                            <td>{{ purchase.purchaseDate|date('d-m-Y') }}</td>
                        </tr>
                        <tr>
                            <th>Supplier</th>
                            <td><a href="{{ path('supplier_show', {'id' : purchase.supplier.id}) }}">{{ purchase.supplier }}</a></td>
                        </tr>
                        <tr>
                            <th>Status</th>
                            <td>
                                {% if purchase.status == statusFinalized %}
                                    <span class="status status-success">Finalized</span>
                                {% else %}
                                    <span class="status status-pending">Not finalized</span>
                                {% endif %}
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="panel panel-archon">
                <div class="panel-heading">
                    <h3 class="panel-title">Products
                        <span class="pull-right">
                            <a class="panel-minimize" href="#"><i class="fa fa-chevron-up"></i></a>
                        </span>
                    </h3>
                </div>
                <div class="panel-body">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Amount</th>
                                <th>Price</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for line in purchaseLines %}
                            <tr>
                                <td>{{ line.product }}</td>
                                <td>{{ line.amount }}</td>
                                <td>{{ line.price }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-archon">
                <div class="well-sm">
                    {% if statusSaved == purchase.status %}
                    <a href="{{ path('finalize_purchase', { 'id' : purchase.id }) }}" class="btn btn-success finalize">Finalize this record</a>
                    {% endif %}

                    {% if statusFinalized == purchase.status %}
                        <a href="{{ path('de_finalize_purchase', { 'id' : purchase.id }) }}" class="btn btn-danger">De-Finalize this record</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

{% endblock %}
